"use strict";angular.module("materialCalendar",["ngMaterial","ngSanitize"]),angular.module("materialCalendar").constant("materialCalendar.config",{version:"0.2.15",debug:-1<document.domain.indexOf("localhost")}),angular.module("materialCalendar").config(["materialCalendar.config","$logProvider","$compileProvider",function(t,a,e){t.debug&&(a.debugEnabled(!1),e.debugInfoEnabled(!1))}]),angular.module("materialCalendar").directive("compile",["$compile",function(o){return function(a,e,n){a.$watch(function(t){return t.$eval(n.compile)},function(t){e.html(t),o(e.contents())(a)})}}]),angular.module("materialCalendar").service("materialCalendar.Calendar",[function(){return function(t,a,e){var d=this,n=new Date;this.setWeekStartsOn=function(t){var a=parseInt(t||0,10);return!isNaN(a)&&0<=a&&a<=6?d.weekStartsOn=a:d.weekStartsOn=0,d.weekStartsOn},this.setStartDateOfMonth=function(t){var a=parseInt(t||1,10);return!isNaN(a)&&1<=a&&a<=31?d.startDateOfMonth=a:d.startDateOfMonth=1,d.startDateOfMonth},this.setNoOfDays=function(t){var a=parseInt(t||0,10);return!isNaN(a)&&0<a?d.noOfDays=a:d.noOfDays=0,d.noOfDays},this.options=angular.isObject(e)?e:{},this.year=n.getFullYear(),this.month=n.getMonth(),this.weeks=[],this.weekStartsOn=this.setWeekStartsOn(this.options.weekStartsOn),this.startDateOfMonth=this.setStartDateOfMonth(this.options.startDateOfMonth),this.noOfDays=this.setNoOfDays(this.options.noOfDays),this.next=function(){d.start.getMonth()<11?d.init(d.start.getFullYear(),d.start.getMonth()+1):d.init(d.start.getFullYear()+1,0)},this.prev=function(){d.month?d.init(d.start.getFullYear(),d.start.getMonth()-1):d.init(d.start.getFullYear()-1,11)},this.init=function(t,a){var e=new Date;d.year=angular.isDefined(t)?t:e.getFullYear(),d.month=angular.isDefined(a)?a:e.getMonth();var n=[31,28,31,30,31,30,31,31,30,31,30,31][d.month];1===d.month&&(d.year%4==0&&d.year%100!=0||d.year%400==0)&&(n=29),angular.isDefined(d.options.startDateOfMonth)?d.start=new Date(d.year,d.month,d.startDateOfMonth):d.start=new Date(d.year,d.month,1);var o=angular.copy(d.start);if(1===o.getDate())for(;o.getDay()!==d.weekStartsOn;)o.setDate(o.getDate()-1),n++;if(0!==d.noOfDays){for(;d.noOfDays%7!=0;)d.noOfDays++;n=d.noOfDays}else for(;n%7!=0;)n++;for(;n%7!=0;)n++;d.weeks=[];for(var r=0;r<n;++r)r%7==0&&d.weeks.push([]),d.weeks[d.weeks.length-1].push(angular.copy(o)),o.setDate(o.getDate()+1)},this.init(t,a)}}]),angular.module("materialCalendar").service("MaterialCalendarData",[function(){return new function(){var e=this;this.data={},this.getDayKey=function(t){return[t.getFullYear(),t.getMonth()+1,t.getDate()].join("-")},this.setDayContent=function(t,a){e.data[e.getDayKey(t)]=a||""}}}]),angular.module("materialCalendar").directive("calendarMd",["$compile","$parse","$templateRequest","$q","materialCalendar.Calendar","MaterialCalendarData",function(h,f,y,p,v,b){return{restrict:"E",scope:{ngModel:"=?",template:"&",templateUrl:"=?",onDayClick:"=?",onPrevMonth:"=?",onNextMonth:"=?",calendarDirection:"=?",dayContent:"&?",timezone:"=?",titleFormat:"=?",dayFormat:"=?",dayLabelFormat:"=?",dayLabelTooltipFormat:"=?",dayTooltipFormat:"=?",weekStartsOn:"=?",tooltips:"&?",startDateOfMonth:"=?",noOfDays:"=?",clearDataCacheOnLoad:"=?",disableFutureSelection:"=?",disableSelection:"=?"},link:function(r,a,n){!function(){var t="calendarMdCss";if(!document.getElementById(t)){var a=document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",e.id=t,e.innerHTML="calendar-md{display:block;max-height:100%}calendar-md .md-toolbar-tools h2{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}calendar-md .md-toolbar-tools .moveNext{-webkit-transform:translate3d(0,0,0) rotate(180deg);transform:translate3d(0,0,0) rotate(180deg)}calendar-md md-content>md-content{border:1px solid rgba(0,0,0,.12)}calendar-md md-content>md-content.agenda>*>*{border-bottom:1px solid rgba(0,0,0,.12)}calendar-md md-content>md-content.agenda>*>.disabled{color:rgba(0,0,0,.3);pointer-events:none;cursor:auto}calendar-md md-content>md-content.agenda>*>.has-events{background-color:#96ca2d}calendar-md md-content>md-content.agenda>*>* :first-child{padding:12px;width:200px;text-align:right;color:rgba(0,0,0,.75);font-weight:100;overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}calendar-md md-content>md-content.agenda>*>* :not(:first-child){overflow:hidden;text-overflow:ellipsis}calendar-md md-content>md-content>*>*{min-width:48px}calendar-md md-content>md-content.calendar>:first-child{background:rgba(0,0,0,.02);border-bottom:1px solid rgba(0,0,0,.12);margin-right:0;min-height:36px}calendar-md md-content>md-content.calendar>:not(:first-child)>*{border-bottom:1px solid rgba(0,0,0,.12);border-right:1px solid rgba(0,0,0,.12);cursor:pointer}calendar-md md-content>md-content.calendar>:not(:first-child)>:hover{background:rgba(0,0,0,.04)}calendar-md md-content>md-content.calendar>:not(:first-child)>.disabled{color:rgba(0,0,0,.3);pointer-events:none;cursor:auto}calendar-md md-content>md-content.calendar>:not(:first-child)>.active{-webkit-box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);background:rgba(0,0,0,.02)}calendar-md md-content>md-content.calendar>:not(:first-child)>.has-events{background-color:#96ca2d}calendar-md md-content>md-content.calendar>:not(:first-child)>* :first-child{padding:0}calendar-md md-content>md-content.calendar>:not(:first-child)>* :last-child{overflow:hidden;text-overflow:ellipsis}",a.insertBefore(e,a.firstChild)}}();var t=new Date,e=parseInt(n.startMonth||t.getMonth()),o=parseInt(n.startYear||t.getFullYear());r.columnWeekLayout="column",r.weekLayout="row",r.timezone=r.timezone||null,r.noCache=n.clearDataCacheOnLoad||!1,n.ngModel?(r.active=r.$parent.$eval(n.ngModel),n.ngModel&&r.$watch("$parent."+n.ngModel,function(t){r.active=t})):r.active=null,r.titleFormat=r.titleFormat||"LLLL yyyy",r.dayLabelFormat=r.dayLabelFormat||"EEE",r.dayLabelTooltipFormat=r.dayLabelTooltipFormat||"EEEE",r.dayFormat=r.dayFormat||"d",r.dayTooltipFormat=r.dayTooltipFormat||"fullDate",r.dayIdFormat="dd-MM-yy",r.disableFutureSelection=r.disableFutureSelection||!1,r.disableSelection=r.disableSelection||!1,r.sameMonth=function(t){var a=angular.copy(t);return a.getFullYear()===r.calendar.year&&a.getMonth()===r.calendar.month},r.isDisabled=function(t,a,e){if(0!==e&&angular.isDefined(e)){var n=new Date(r.calendar.year,r.calendar.month,a),o=angular.copy(n);if(o.setDate(n.getDate()+parseInt(e)),t.getDate()<=n&&t.getDate()>=o)return!0}return!!r.disableSelection||(!!(r.disableFutureSelection&&t>new Date)||!r.sameMonth(t))},r.calendarDirection=r.calendarDirection||"horizontal",r.$watch("calendarDirection",function(t){r.weekLayout="horizontal"===t?"row":"column"}),r.$watch("weekLayout",function(){o=r.calendar.year,e=r.calendar.month,g()});var d=function(t,a){return(t||angular.noop)(a)},i=function(t,e){var n=-1;return angular.forEach(t,function(t,a){n<0&&angular.equals(e,t)&&(n=a)}),n};r.isActive=function(t){var a,e=angular.copy(r.active);return angular.isArray(e)?a=-1<i(e,t):e&&angular.equals(e.getYear(),t.getYear())&&angular.equals(e.getMonth(),t.getMonth())&&angular.equals(e.getDate(),t.getDate())&&(a=!0),a},r.hasEvents=function(t){var a=b.data[r.dayKey(t)];return a&&0<a.length},r.prev=function(){r.calendar.prev();var t={year:r.calendar.year,month:r.calendar.month+1};u(),d(r.onPrevMonth,t)},r.next=function(){r.calendar.next();var t={year:r.calendar.year,month:r.calendar.month+1};u(),d(r.onNextMonth,t)},r.handleDayClick=function(t){if(!(r.disableFutureSelection&&t>new Date||r.disableSelection)){var a=angular.copy(r.active);if(angular.isArray(a)){var e=i(a,t);-1<e?a.splice(e,1):a.push(t)}else a=angular.equals(a,t)?null:t;r.active=a,n.ngModel&&f(n.ngModel).assign(r.$parent,angular.copy(r.active)),d(r.onDayClick,angular.copy(t))}};var l=function(t){a.html(t),h(a.contents())(r)},c=function(){return r.calendar=new v(o,e,{weekStartsOn:r.weekStartsOn||0,startDateOfMonth:r.startDateOfMonth||1,noOfDays:r.noOfDays||0}),r.templateUrl?y(r.templateUrl):p.when(r.template()||"<md-content layout='column' layout-fill md-swipe-left='next()' md-swipe-right='prev()'><md-toolbar><div class='md-toolbar-tools' layout='row'><md-button class='md-icon-button' ng-click='prev()' aria-label='Previous month'><md-tooltip ng-if='::tooltips()'>Previous month</md-tooltip><md-icon md-svg-icon='md-tabs-arrow'></md-icon></md-button><div flex></div><h2 class='calendar-md-title'><span>{{ calendar.start | date:titleFormat:timezone }}</span></h2><div flex></div><md-button class='md-icon-button' ng-click='next()' aria-label='Next month'><md-tooltip ng-if='::tooltips()'>Next month</md-tooltip><md-icon md-svg-icon='md-tabs-arrow' class='moveNext'></md-icon></md-button></div></md-toolbar>\x3c!-- agenda view --\x3e<md-content ng-if='weekLayout === columnWeekLayout' class='agenda'><div ng-repeat='week in calendar.weeks track by $index'><div ng-if='sameMonth(day)' ng-class='{'disabled' : isDisabled(day), active: active === day, 'has-events': hasEvents(day) }' ng-click='handleDayClick(day)' ng-repeat='day in week' layout><md-tooltip ng-if='::tooltips()'>{{ day | date:dayTooltipFormat:timezone }}</md-tooltip><div>{{ day | date:dayFormat:timezone }}</div><div flex compile='dataService.data[dayKey(day)]'></div></div></div></md-content>\x3c!-- calendar view --\x3e<md-content ng-if='weekLayout !== columnWeekLayout' flex layout='column' class='calendar'><div layout='row' class='subheader'><div layout-padding class='subheader-day' flex ng-repeat='day in calendar.weeks[0]'><md-tooltip ng-if='::tooltips()'>{{ day | date:dayLabelTooltipFormat }}</md-tooltip>{{ day | date:dayLabelFormat }}</div></div><div ng-if='week.length' ng-repeat='week in calendar.weeks track by $index' flex layout='row'><div tabindex='{{ sameMonth(day) ? (day | date:dayFormat:timezone) : 0 }}' ng-repeat='day in week track by $index' ng-click='handleDayClick(day)' flex layout layout-padding ng-class='{'disabled' : isDisabled(day), 'active': isActive(day), 'has-events': hasEvents(day), 'md-whiteframe-12dp': hover || focus }' ng-focus='focus = true;' ng-blur='focus = false;' ng-mouseleave='hover = false' ng-mouseenter='hover = true'><md-tooltip ng-if='::tooltips()'>{{ day | date:dayTooltipFormat }}</md-tooltip><div>{{ day | date:dayFormat }}</div><div flex compile='dataService.data[dayKey(day)]' id='{{ day | date:dayIdFormat }}'></div></div></div></md-content></md-content>")};r.dataService=b;var s=function(t){return r.dataService.getDayKey(t)};r.dayKey=s;var m=function(a){r.noCache?r.dataService.setDayContent(a,""):r.dataService.setDayContent(a,r.dataService.data[s(a)]||"");var t=((r.dayContent||angular.noop)()||angular.noop)(a);angular.isObject(t)&&"function"==typeof t.success?t.success(function(t){r.dataService.setDayContent(a,t)}):angular.isObject(t)&&"function"==typeof t.then?t.then(function(t){r.dataService.setDayContent(a,t)}):r.dataService.setDayContent(a,t)},u=function(){angular.forEach(r.calendar.weeks,function(t){angular.forEach(t,m)})};window.data=r.data;var g=function(){c().then(function(t){l(t),u()})};r.$watchGroup(["weekStartsOn","startDateOfMonth","noOfDays"],c),g(),r._$$init=c,r._$$setTemplate=l,r._$$bootstrap=g}}}]);